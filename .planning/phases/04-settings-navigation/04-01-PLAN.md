---
phase: 04-settings-navigation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - App.tsx
  - src/navigation/AppNavigator.tsx
  - src/navigation/types.ts
  - src/screens/GameScreen.tsx
  - src/screens/SettingsScreen.tsx
  - src/components/GameHeader.tsx
autonomous: true

must_haves:
  truths:
    - "User can tap a gear icon in the game header to open the settings screen"
    - "Settings screen displays links for theme toggle, rules, report issue, about, and legal pages"
    - "User can navigate back to the game from the settings screen"
  artifacts:
    - path: "src/navigation/AppNavigator.tsx"
      provides: "Stack navigator with Game and Settings screens"
      exports: ["default"]
    - path: "src/navigation/types.ts"
      provides: "Navigation type definitions for RootStackParamList"
      exports: ["RootStackParamList"]
    - path: "src/screens/GameScreen.tsx"
      provides: "Game screen wrapping existing GameHeader, GameBoard, GameFooter, GameOverModal"
      exports: ["default"]
    - path: "src/screens/SettingsScreen.tsx"
      provides: "Settings hub with menu items for theme, rules, report issue, about, privacy, terms"
      exports: ["default"]
    - path: "src/components/GameHeader.tsx"
      provides: "Updated header with gear icon that navigates to Settings"
      exports: ["default"]
    - path: "App.tsx"
      provides: "Root app wrapping NavigationContainer around AppNavigator"
      exports: ["default"]
  key_links:
    - from: "src/components/GameHeader.tsx"
      to: "Settings screen"
      via: "useNavigation().navigate('Settings')"
      pattern: "navigation\\.navigate.*Settings"
    - from: "App.tsx"
      to: "src/navigation/AppNavigator.tsx"
      via: "NavigationContainer wrapping AppNavigator"
      pattern: "NavigationContainer"
    - from: "src/navigation/AppNavigator.tsx"
      to: "src/screens/GameScreen.tsx, src/screens/SettingsScreen.tsx"
      via: "Stack.Screen components"
      pattern: "Stack\\.Screen.*name=.(Game|Settings)"
---

<objective>
Add stack navigation to the app and create a settings hub screen accessible from the game header.

Purpose: This is the navigation skeleton for v1.1 — all subsequent phases (theming, info/legal screens) depend on this navigation infrastructure and settings screen existing.
Output: Working two-screen app with Game (default) and Settings screens, connected via a gear icon in the header.
</objective>

<execution_context>
@/Users/giangnguyen/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/giangnguyen/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@App.tsx
@src/components/GameHeader.tsx
@src/theme/colors.ts
@package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install React Navigation and create stack navigator with GameScreen</name>
  <files>
    package.json
    src/navigation/types.ts
    src/navigation/AppNavigator.tsx
    src/screens/GameScreen.tsx
    src/screens/SettingsScreen.tsx
    App.tsx
  </files>
  <action>
1. Install React Navigation dependencies:
   `npx expo install @react-navigation/native @react-navigation/native-stack react-native-screens react-native-safe-area-context`
   (Use `npx expo install` NOT `npm install` — ensures Expo-compatible versions.)

2. Create `src/navigation/types.ts`:
   - Export `RootStackParamList` type with `Game: undefined` and `Settings: undefined`
   - Export typed navigation hook: `useAppNavigation` wrapping `useNavigation<NativeStackNavigationProp<RootStackParamList>>()`

3. Create `src/screens/GameScreen.tsx`:
   - Move the current App.tsx content (SafeAreaView containing GameHeader, GameBoard, GameFooter, GameOverModal, StatusBar) into this component
   - Keep the same styles (flex: 1, backgroundColor: colors.background)
   - Import components from relative paths (`../components/GameHeader`, etc.)

4. Create `src/screens/SettingsScreen.tsx`:
   - Minimal placeholder for now: a View with `flex: 1, backgroundColor: colors.background` and a centered Text saying "Settings"
   - This will be fleshed out in Task 2

5. Create `src/navigation/AppNavigator.tsx`:
   - Create a native stack navigator using `createNativeStackNavigator<RootStackParamList>()`
   - Two screens: `Game` (component: GameScreen) and `Settings` (component: SettingsScreen)
   - Game screen options: `headerShown: false` (we use our custom GameHeader)
   - Settings screen options: `title: 'Settings'`, style the native header to match dark theme (headerStyle backgroundColor: colors.background, headerTintColor: colors.text, headerShadowVisible: false)
   - Set `initialRouteName: 'Game'`

6. Update `App.tsx`:
   - Replace all current content with: NavigationContainer wrapping AppNavigator
   - Import NavigationContainer from `@react-navigation/native`
   - Import AppNavigator from `./src/navigation/AppNavigator`
   - Keep StatusBar with style="light" outside NavigationContainer (at same level)
   - Remove SafeAreaView, GameHeader, GameBoard, GameFooter, GameOverModal imports (now in GameScreen)
  </action>
  <verify>
    Run `npx expo start` — app should launch showing the same game screen as before (no visual regression). The native stack navigator is invisible since Game screen has headerShown: false and contains all existing components.
    Run `npx tsc --noEmit` — no TypeScript errors.
  </verify>
  <done>
    App renders identically to before. Navigation infrastructure is in place with two registered screens (Game and Settings). No visual changes yet — gear icon added in Task 2.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add gear icon to GameHeader and build SettingsScreen menu</name>
  <files>
    src/components/GameHeader.tsx
    src/screens/SettingsScreen.tsx
  </files>
  <action>
1. Update `src/components/GameHeader.tsx`:
   - Import `TouchableOpacity` from react-native
   - Import `Ionicons` from `@expo/vector-icons` (included in Expo SDK — no install needed)
   - Import `useAppNavigation` from `../navigation/types`
   - Restructure the header layout: wrap the title row to have "Sleek Match" on the left and a gear icon on the right
   - Change the title container to use `flexDirection: 'row'` with `justifyContent: 'space-between'` and `alignItems: 'center'`
   - Add a TouchableOpacity with an `<Ionicons name="settings-outline" size={24} color={colors.text} />` on the right side
   - onPress: `navigation.navigate('Settings')`
   - Keep the score row below exactly as it is

2. Build `src/screens/SettingsScreen.tsx`:
   - Import `ScrollView`, `View`, `Text`, `TouchableOpacity`, `StyleSheet` from react-native
   - Import `Ionicons` from `@expo/vector-icons`
   - Import `colors` from `../theme/colors`
   - Create a ScrollView with backgroundColor: colors.background, flex: 1
   - Create menu sections with grouped items. Use a reusable `SettingsItem` internal component that renders a TouchableOpacity row with:
     - Left side: Ionicons icon (24px, colors.accent) + label text (16px, colors.text)
     - Right side: chevron-forward icon (20px, colors.textSecondary)
     - Row style: flexDirection: 'row', alignItems: 'center', justifyContent: 'space-between', paddingVertical: 14, paddingHorizontal: 16, borderBottomWidth: StyleSheet.hairlineWidth, borderBottomColor: colors.surface
   - Menu items (in order, grouped by section):
     **Preferences section** (section header text "PREFERENCES", 12px, colors.textSecondary, uppercase, paddingHorizontal: 16, paddingTop: 24, paddingBottom: 8):
       - "Theme" with icon "color-palette-outline" — onPress: no-op for now (Phase 5)
     **Information section** (section header "INFORMATION"):
       - "Game Rules" with icon "book-outline" — onPress: no-op (Phase 6)
       - "Report Issue" with icon "bug-outline" — onPress: no-op (Phase 6)
       - "About" with icon "information-circle-outline" — onPress: no-op (Phase 6)
     **Legal section** (section header "LEGAL"):
       - "Privacy Policy" with icon "shield-checkmark-outline" — onPress: no-op (Phase 6)
       - "Terms & Conditions" with icon "document-text-outline" — onPress: no-op (Phase 6)
   - Add a version label at the bottom: "Version 1.0.0" centered, colors.textSecondary, fontSize: 13, marginTop: 32
   - All menu items have `onPress` as a prop, currently set to `() => {}` — these will be wired in Phase 5 and 6
  </action>
  <verify>
    Run `npx expo start` — verify:
    1. Gear icon appears in the game header (top-right area, next to "Sleek Match" title)
    2. Tapping gear icon navigates to Settings screen
    3. Settings screen shows all 6 menu items grouped under 3 sections
    4. Native back arrow in Settings header navigates back to the game
    5. Game state is preserved when navigating back (score, board position unchanged)
    Run `npx tsc --noEmit` — no TypeScript errors.
  </verify>
  <done>
    Gear icon in GameHeader opens Settings screen. Settings displays 6 menu items (Theme, Game Rules, Report Issue, About, Privacy Policy, Terms & Conditions) under 3 section headers. Back navigation returns to game with state intact. All menu items are visual placeholders (onPress: no-op) ready for Phase 5 and 6 wiring.
  </done>
</task>

</tasks>

<verification>
- [ ] `npx tsc --noEmit` passes with no errors
- [ ] App launches showing game screen (no visual regression from v1.0)
- [ ] Gear icon visible in GameHeader, tappable
- [ ] Tapping gear navigates to Settings screen with native header showing "Settings" and back arrow
- [ ] Settings shows 6 menu items under 3 sections (Preferences, Information, Legal)
- [ ] Back arrow returns to game with state preserved
- [ ] No navigation-related warnings in console
</verification>

<success_criteria>
NAV-01: Gear icon in game header opens settings — DONE
NAV-02: Settings displays links for theme, rules, report issue, about, privacy, terms — DONE
NAV-03: User can navigate back to game from settings — DONE
</success_criteria>

<output>
After completion, create `.planning/phases/04-settings-navigation/04-01-SUMMARY.md`
</output>
